<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href='https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css' rel='stylesheet' type='text/css' />
    <style>
      article.markdown-body {
        box-sizing: border-box;
        min-width: 200px;
        max-width: 980px;
        margin: 0 auto;
        padding: 45px;
      }

      span.line-numbers {
        display: none;
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
  </head>
  <body>
    <article class='markdown-body'>
      <h2 id="section">テスト</h2>

<h3 id="section-1">コードを書く</h3>

<p><em>~~~ruby</em> と <em>~~~</em> でコードを囲むと、そのブロックが評価される。</p>

<pre><code class="language-ruby">array = [1,2,3,4]
converted = array.map { |e| e * 100 }

converted # 最後の行が出力される
</code></pre>
<p>  <pre><code>=&gt; [100, 200, 300, 400]
</code></pre>
</p>

<p>標準出力も表示される</p>

<pre><code class="language-ruby">puts :hoge

"fuga\npiyo".inspect
</code></pre>
<p>  <pre><code>hoge

=&gt; "fuga\npiyo"
</code></pre>
</p>

<h3 id="section-2">ブロックは全部同じスコープ</h3>

<p>先程定義した変数<code>converted</code>が以下でも使える。</p>

<pre><code class="language-ruby">converted.map { |e| e / 100 }
</code></pre>
<p>  <pre><code>=&gt; [1, 2, 3, 4]
</code></pre>
</p>

<h3 id="section-3">ライブラリを使う</h3>

<p>もちろん外部のライブラリをロードすることもできる。</p>

<pre><code class="language-ruby">require 'matrix'

Matrix.identity(10)
</code></pre>
<p>  <pre><code>=&gt; Matrix[[1, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 1, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 1, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 1, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 1, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]]
</code></pre>
</p>

<h3 id="tohtml">to_htmlを実装する</h3>

<p><code>to_html</code> メソッドを実装すると、その結果が出力される。</p>

<pre><code class="language-ruby">class Matrix # オープンクラス
  def to_html
    rows = self.to_a.map do |row|
      elems = row.map do |elem|
        "&lt;td&gt;#{elem}&lt;/td&gt;"
      end
      "&lt;tr&gt;#{elems}&lt;/tr&gt;"
    end
    "&lt;table&gt;#{rows.join}&lt;/table&gt;"
  end
end

Matrix.identity(10)
</code></pre>
  <table>
    <tbody>
      <tr>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
      <tr>
        <td>0</td>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
      <tr>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
      <tr>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
      <tr>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
      <tr>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
      <tr>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
      <tr>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>0</td>
        <td>0</td>
      </tr>
      <tr>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>0</td>
      </tr>
      <tr>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
      </tr>
    </tbody>
  </table>

    </article>
  </body>
</html>
