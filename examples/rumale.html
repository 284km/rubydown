<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href='https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css' rel='stylesheet' type='text/css' />
    <style>
      article.markdown-body {
        box-sizing: border-box;
        min-width: 200px;
        max-width: 980px;
        margin: 0 auto;
        padding: 45px;
      }

      span.line-numbers {
        display: none;
      }
    </style>
  </head>
  <body>
    <article class='markdown-body'>
      <p>Rumale machine learning examples</p>

<pre><code class="language-ruby">require 'rumale'
require 'rdatasets'

iris = RDatasets.load(:datasets, :iris)

iris_labels = iris['Species'].to_a
encoder = Rumale::Preprocessing::LabelEncoder.new
labels = encoder.fit_transform(iris_labels)
p "hoge"
</code></pre>
<p>  <pre><code>"hoge"

=&gt; hoge
</code></pre>
</p>

<pre><code class="language-ruby">samples = Numo::DFloat[*iris[0..3].to_matrix.to_a]
</code></pre>
  <table>
    <tbody>
      <tr>
        <td>5.1</td>
        <td>3.5</td>
        <td>1.4</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.9</td>
        <td>3.0</td>
        <td>1.4</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.7</td>
        <td>3.2</td>
        <td>1.3</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.6</td>
        <td>3.1</td>
        <td>1.5</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>3.6</td>
        <td>1.4</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.4</td>
        <td>3.9</td>
        <td>1.7</td>
        <td>0.4</td>
      </tr>
      <tr>
        <td>4.6</td>
        <td>3.4</td>
        <td>1.4</td>
        <td>0.3</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>3.4</td>
        <td>1.5</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.4</td>
        <td>2.9</td>
        <td>1.4</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.9</td>
        <td>3.1</td>
        <td>1.5</td>
        <td>0.1</td>
      </tr>
      <tr>
        <td>5.4</td>
        <td>3.7</td>
        <td>1.5</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.8</td>
        <td>3.4</td>
        <td>1.6</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.8</td>
        <td>3.0</td>
        <td>1.4</td>
        <td>0.1</td>
      </tr>
      <tr>
        <td>4.3</td>
        <td>3.0</td>
        <td>1.1</td>
        <td>0.1</td>
      </tr>
      <tr>
        <td>5.8</td>
        <td>4.0</td>
        <td>1.2</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.7</td>
        <td>4.4</td>
        <td>1.5</td>
        <td>0.4</td>
      </tr>
      <tr>
        <td>5.4</td>
        <td>3.9</td>
        <td>1.3</td>
        <td>0.4</td>
      </tr>
      <tr>
        <td>5.1</td>
        <td>3.5</td>
        <td>1.4</td>
        <td>0.3</td>
      </tr>
      <tr>
        <td>5.7</td>
        <td>3.8</td>
        <td>1.7</td>
        <td>0.3</td>
      </tr>
      <tr>
        <td>5.1</td>
        <td>3.8</td>
        <td>1.5</td>
        <td>0.3</td>
      </tr>
      <tr>
        <td>5.4</td>
        <td>3.4</td>
        <td>1.7</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.1</td>
        <td>3.7</td>
        <td>1.5</td>
        <td>0.4</td>
      </tr>
      <tr>
        <td>4.6</td>
        <td>3.6</td>
        <td>1.0</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.1</td>
        <td>3.3</td>
        <td>1.7</td>
        <td>0.5</td>
      </tr>
      <tr>
        <td>4.8</td>
        <td>3.4</td>
        <td>1.9</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>3.0</td>
        <td>1.6</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>3.4</td>
        <td>1.6</td>
        <td>0.4</td>
      </tr>
      <tr>
        <td>5.2</td>
        <td>3.5</td>
        <td>1.5</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.2</td>
        <td>3.4</td>
        <td>1.4</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.7</td>
        <td>3.2</td>
        <td>1.6</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.8</td>
        <td>3.1</td>
        <td>1.6</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.4</td>
        <td>3.4</td>
        <td>1.5</td>
        <td>0.4</td>
      </tr>
      <tr>
        <td>5.2</td>
        <td>4.1</td>
        <td>1.5</td>
        <td>0.1</td>
      </tr>
      <tr>
        <td>5.5</td>
        <td>4.2</td>
        <td>1.4</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.9</td>
        <td>3.1</td>
        <td>1.5</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>3.2</td>
        <td>1.2</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.5</td>
        <td>3.5</td>
        <td>1.3</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.9</td>
        <td>3.6</td>
        <td>1.4</td>
        <td>0.1</td>
      </tr>
      <tr>
        <td>4.4</td>
        <td>3.0</td>
        <td>1.3</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.1</td>
        <td>3.4</td>
        <td>1.5</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>3.5</td>
        <td>1.3</td>
        <td>0.3</td>
      </tr>
      <tr>
        <td>4.5</td>
        <td>2.3</td>
        <td>1.3</td>
        <td>0.3</td>
      </tr>
      <tr>
        <td>4.4</td>
        <td>3.2</td>
        <td>1.3</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>3.5</td>
        <td>1.6</td>
        <td>0.6</td>
      </tr>
      <tr>
        <td>5.1</td>
        <td>3.8</td>
        <td>1.9</td>
        <td>0.4</td>
      </tr>
      <tr>
        <td>4.8</td>
        <td>3.0</td>
        <td>1.4</td>
        <td>0.3</td>
      </tr>
      <tr>
        <td>5.1</td>
        <td>3.8</td>
        <td>1.6</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>4.6</td>
        <td>3.2</td>
        <td>1.4</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.3</td>
        <td>3.7</td>
        <td>1.5</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>3.3</td>
        <td>1.4</td>
        <td>0.2</td>
      </tr>
      <tr>
        <td>7.0</td>
        <td>3.2</td>
        <td>4.7</td>
        <td>1.4</td>
      </tr>
      <tr>
        <td>6.4</td>
        <td>3.2</td>
        <td>4.5</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>6.9</td>
        <td>3.1</td>
        <td>4.9</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>5.5</td>
        <td>2.3</td>
        <td>4.0</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>6.5</td>
        <td>2.8</td>
        <td>4.6</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>5.7</td>
        <td>2.8</td>
        <td>4.5</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>6.3</td>
        <td>3.3</td>
        <td>4.7</td>
        <td>1.6</td>
      </tr>
      <tr>
        <td>4.9</td>
        <td>2.4</td>
        <td>3.3</td>
        <td>1.0</td>
      </tr>
      <tr>
        <td>6.6</td>
        <td>2.9</td>
        <td>4.6</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>5.2</td>
        <td>2.7</td>
        <td>3.9</td>
        <td>1.4</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>2.0</td>
        <td>3.5</td>
        <td>1.0</td>
      </tr>
      <tr>
        <td>5.9</td>
        <td>3.0</td>
        <td>4.2</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>6.0</td>
        <td>2.2</td>
        <td>4.0</td>
        <td>1.0</td>
      </tr>
      <tr>
        <td>6.1</td>
        <td>2.9</td>
        <td>4.7</td>
        <td>1.4</td>
      </tr>
      <tr>
        <td>5.6</td>
        <td>2.9</td>
        <td>3.6</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>6.7</td>
        <td>3.1</td>
        <td>4.4</td>
        <td>1.4</td>
      </tr>
      <tr>
        <td>5.6</td>
        <td>3.0</td>
        <td>4.5</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>5.8</td>
        <td>2.7</td>
        <td>4.1</td>
        <td>1.0</td>
      </tr>
      <tr>
        <td>6.2</td>
        <td>2.2</td>
        <td>4.5</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>5.6</td>
        <td>2.5</td>
        <td>3.9</td>
        <td>1.1</td>
      </tr>
      <tr>
        <td>5.9</td>
        <td>3.2</td>
        <td>4.8</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>6.1</td>
        <td>2.8</td>
        <td>4.0</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>6.3</td>
        <td>2.5</td>
        <td>4.9</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>6.1</td>
        <td>2.8</td>
        <td>4.7</td>
        <td>1.2</td>
      </tr>
      <tr>
        <td>6.4</td>
        <td>2.9</td>
        <td>4.3</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>6.6</td>
        <td>3.0</td>
        <td>4.4</td>
        <td>1.4</td>
      </tr>
      <tr>
        <td>6.8</td>
        <td>2.8</td>
        <td>4.8</td>
        <td>1.4</td>
      </tr>
      <tr>
        <td>6.7</td>
        <td>3.0</td>
        <td>5.0</td>
        <td>1.7</td>
      </tr>
      <tr>
        <td>6.0</td>
        <td>2.9</td>
        <td>4.5</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>5.7</td>
        <td>2.6</td>
        <td>3.5</td>
        <td>1.0</td>
      </tr>
      <tr>
        <td>5.5</td>
        <td>2.4</td>
        <td>3.8</td>
        <td>1.1</td>
      </tr>
      <tr>
        <td>5.5</td>
        <td>2.4</td>
        <td>3.7</td>
        <td>1.0</td>
      </tr>
      <tr>
        <td>5.8</td>
        <td>2.7</td>
        <td>3.9</td>
        <td>1.2</td>
      </tr>
      <tr>
        <td>6.0</td>
        <td>2.7</td>
        <td>5.1</td>
        <td>1.6</td>
      </tr>
      <tr>
        <td>5.4</td>
        <td>3.0</td>
        <td>4.5</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>6.0</td>
        <td>3.4</td>
        <td>4.5</td>
        <td>1.6</td>
      </tr>
      <tr>
        <td>6.7</td>
        <td>3.1</td>
        <td>4.7</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>6.3</td>
        <td>2.3</td>
        <td>4.4</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>5.6</td>
        <td>3.0</td>
        <td>4.1</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>5.5</td>
        <td>2.5</td>
        <td>4.0</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>5.5</td>
        <td>2.6</td>
        <td>4.4</td>
        <td>1.2</td>
      </tr>
      <tr>
        <td>6.1</td>
        <td>3.0</td>
        <td>4.6</td>
        <td>1.4</td>
      </tr>
      <tr>
        <td>5.8</td>
        <td>2.6</td>
        <td>4.0</td>
        <td>1.2</td>
      </tr>
      <tr>
        <td>5.0</td>
        <td>2.3</td>
        <td>3.3</td>
        <td>1.0</td>
      </tr>
      <tr>
        <td>5.6</td>
        <td>2.7</td>
        <td>4.2</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>5.7</td>
        <td>3.0</td>
        <td>4.2</td>
        <td>1.2</td>
      </tr>
      <tr>
        <td>5.7</td>
        <td>2.9</td>
        <td>4.2</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>6.2</td>
        <td>2.9</td>
        <td>4.3</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>5.1</td>
        <td>2.5</td>
        <td>3.0</td>
        <td>1.1</td>
      </tr>
      <tr>
        <td>5.7</td>
        <td>2.8</td>
        <td>4.1</td>
        <td>1.3</td>
      </tr>
      <tr>
        <td>6.3</td>
        <td>3.3</td>
        <td>6.0</td>
        <td>2.5</td>
      </tr>
      <tr>
        <td>5.8</td>
        <td>2.7</td>
        <td>5.1</td>
        <td>1.9</td>
      </tr>
      <tr>
        <td>7.1</td>
        <td>3.0</td>
        <td>5.9</td>
        <td>2.1</td>
      </tr>
      <tr>
        <td>6.3</td>
        <td>2.9</td>
        <td>5.6</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>6.5</td>
        <td>3.0</td>
        <td>5.8</td>
        <td>2.2</td>
      </tr>
      <tr>
        <td>7.6</td>
        <td>3.0</td>
        <td>6.6</td>
        <td>2.1</td>
      </tr>
      <tr>
        <td>4.9</td>
        <td>2.5</td>
        <td>4.5</td>
        <td>1.7</td>
      </tr>
      <tr>
        <td>7.3</td>
        <td>2.9</td>
        <td>6.3</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>6.7</td>
        <td>2.5</td>
        <td>5.8</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>7.2</td>
        <td>3.6</td>
        <td>6.1</td>
        <td>2.5</td>
      </tr>
      <tr>
        <td>6.5</td>
        <td>3.2</td>
        <td>5.1</td>
        <td>2.0</td>
      </tr>
      <tr>
        <td>6.4</td>
        <td>2.7</td>
        <td>5.3</td>
        <td>1.9</td>
      </tr>
      <tr>
        <td>6.8</td>
        <td>3.0</td>
        <td>5.5</td>
        <td>2.1</td>
      </tr>
      <tr>
        <td>5.7</td>
        <td>2.5</td>
        <td>5.0</td>
        <td>2.0</td>
      </tr>
      <tr>
        <td>5.8</td>
        <td>2.8</td>
        <td>5.1</td>
        <td>2.4</td>
      </tr>
      <tr>
        <td>6.4</td>
        <td>3.2</td>
        <td>5.3</td>
        <td>2.3</td>
      </tr>
      <tr>
        <td>6.5</td>
        <td>3.0</td>
        <td>5.5</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>7.7</td>
        <td>3.8</td>
        <td>6.7</td>
        <td>2.2</td>
      </tr>
      <tr>
        <td>7.7</td>
        <td>2.6</td>
        <td>6.9</td>
        <td>2.3</td>
      </tr>
      <tr>
        <td>6.0</td>
        <td>2.2</td>
        <td>5.0</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>6.9</td>
        <td>3.2</td>
        <td>5.7</td>
        <td>2.3</td>
      </tr>
      <tr>
        <td>5.6</td>
        <td>2.8</td>
        <td>4.9</td>
        <td>2.0</td>
      </tr>
      <tr>
        <td>7.7</td>
        <td>2.8</td>
        <td>6.7</td>
        <td>2.0</td>
      </tr>
      <tr>
        <td>6.3</td>
        <td>2.7</td>
        <td>4.9</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>6.7</td>
        <td>3.3</td>
        <td>5.7</td>
        <td>2.1</td>
      </tr>
      <tr>
        <td>7.2</td>
        <td>3.2</td>
        <td>6.0</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>6.2</td>
        <td>2.8</td>
        <td>4.8</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>6.1</td>
        <td>3.0</td>
        <td>4.9</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>6.4</td>
        <td>2.8</td>
        <td>5.6</td>
        <td>2.1</td>
      </tr>
      <tr>
        <td>7.2</td>
        <td>3.0</td>
        <td>5.8</td>
        <td>1.6</td>
      </tr>
      <tr>
        <td>7.4</td>
        <td>2.8</td>
        <td>6.1</td>
        <td>1.9</td>
      </tr>
      <tr>
        <td>7.9</td>
        <td>3.8</td>
        <td>6.4</td>
        <td>2.0</td>
      </tr>
      <tr>
        <td>6.4</td>
        <td>2.8</td>
        <td>5.6</td>
        <td>2.2</td>
      </tr>
      <tr>
        <td>6.3</td>
        <td>2.8</td>
        <td>5.1</td>
        <td>1.5</td>
      </tr>
      <tr>
        <td>6.1</td>
        <td>2.6</td>
        <td>5.6</td>
        <td>1.4</td>
      </tr>
      <tr>
        <td>7.7</td>
        <td>3.0</td>
        <td>6.1</td>
        <td>2.3</td>
      </tr>
      <tr>
        <td>6.3</td>
        <td>3.4</td>
        <td>5.6</td>
        <td>2.4</td>
      </tr>
      <tr>
        <td>6.4</td>
        <td>3.1</td>
        <td>5.5</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>6.0</td>
        <td>3.0</td>
        <td>4.8</td>
        <td>1.8</td>
      </tr>
      <tr>
        <td>6.9</td>
        <td>3.1</td>
        <td>5.4</td>
        <td>2.1</td>
      </tr>
      <tr>
        <td>6.7</td>
        <td>3.1</td>
        <td>5.6</td>
        <td>2.4</td>
      </tr>
      <tr>
        <td>6.9</td>
        <td>3.1</td>
        <td>5.1</td>
        <td>2.3</td>
      </tr>
      <tr>
        <td>5.8</td>
        <td>2.7</td>
        <td>5.1</td>
        <td>1.9</td>
      </tr>
      <tr>
        <td>6.8</td>
        <td>3.2</td>
        <td>5.9</td>
        <td>2.3</td>
      </tr>
      <tr>
        <td>6.7</td>
        <td>3.3</td>
        <td>5.7</td>
        <td>2.5</td>
      </tr>
      <tr>
        <td>6.7</td>
        <td>3.0</td>
        <td>5.2</td>
        <td>2.3</td>
      </tr>
      <tr>
        <td>6.3</td>
        <td>2.5</td>
        <td>5.0</td>
        <td>1.9</td>
      </tr>
      <tr>
        <td>6.5</td>
        <td>3.0</td>
        <td>5.2</td>
        <td>2.0</td>
      </tr>
      <tr>
        <td>6.2</td>
        <td>3.4</td>
        <td>5.4</td>
        <td>2.3</td>
      </tr>
      <tr>
        <td>5.9</td>
        <td>3.0</td>
        <td>5.1</td>
        <td>1.8</td>
      </tr>
    </tbody>
  </table>

<pre><code class="language-ruby">model = Rumale::LinearModel::SVC.new(
  reg_param: 0.0001,
  fit_bias: true,
  max_iter: 3000,
  random_seed: 1
)

model.fit(samples, labels)

p model.predict(samples).to_a
</code></pre>
<p>  <pre><code>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]

=&gt; [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
</code></pre>
</p>

    </article>
  </body>
</html>
